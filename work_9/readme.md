1. Для выполнения дз необходимо подготовить окружение
установить почтового клиента для отправке email уведомлений.

sudo yum -y update
sudo yum install -y mailx

2. Некоторые сценарии и приложения мониторинга могут использовать “email” вместо “mail” или “mailx” для отправки электронных писем. Если вы окажетесь в такой ситуации, вы можете создать символическую ссылку, указывающую (ссылающуюся) на mailx.
создаем символическую ссылку для “mail” для выполнения “mailx”.
Чтобы создать символическую ссылку, выполните следующее (замените /bin/emailна требуемое имя ссылки):

$ ln -s /bin/mailx /bin/email

3. Чтобы настроить SMTP-сервер [конфигурация] для использования “mailx”, нам нужно отредактировать содержимое /etc/mail.rcфайла, в котором находятся [определенные] настройки приложения. Мы собираемся открыть этот файл с помощью текстового редактора “nano” и добавить наши настройки сверху.

Откройте “mail.rc” с помощью “nano”:

$ nano /etc/mail.rc
Ниже вы можете найти пример настроек SMTP, которые вам нужно будет изменить, чтобы они соответствовали настройкам вашего провайдера, прежде чем добавлять их в начало “mail.rc”. Строки, начинающиеся со знака #, закомментированы - это означает, что они не действуют - и состоят из структуры. Следующая строка - это та, которую вам нужно будет соответствующим образом заменить, чтобы соответствовать данным вашего SMTP-сервера.

Пример:

set smtp=smtp://smtp.server.tld:port_number
set smtp=smtp://smtp.example.com:543
tell mailx that it needs to authorise
set smtp-auth=login
set the user for SMTP
set smtp-auth-user=user@domain.tld
set smtp-auth-user=user.name@example.com
set the password for authorisation
set smtp-auth-password=enter-password-here-1234
Нажмите “CTRL + X” и подтвердите “Y”, чтобы сохранить и выйти.

4. В скрипте парсится тестовый фаил acces.log, для работы в производственной среде необходимо поменять пути к файлу nginx в соответствие с вашим окружением.

5. Добавить скрипт в планировщик cron  crontab -e  
15 * * * * * * /home/scrip/find.sh # указать актуальный путь к файлу. 

